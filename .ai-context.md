# AI Context: Turn-Based Movement Game Engine

## Project Overview
TypeScript-based game engine with GameMaker-style architecture. Features event-driven game objects, immediate-mode rendering with rapid-render, MessagePack binary data system, and a turn-based movement demo game.

## Tech Stack
- **TypeScript** + **Vite** (build/dev)
- **rapid-render** (immediate-mode 2D rendering)
- **HTML5 Canvas** (render target)
- **EasyStar.js** (A* pathfinding)
- **MessagePack** (binary data serialization)

## Architecture

### Core Engine (`src/engine/`)
- **DGCGame** - Base class all games extend, includes RoomManager
- **DGCEngine** - Main game engine with Rapid.js rendering
- **DGCDrawingSystem** - Immediate-mode drawing API
- **GameObject** - Base for all game entities with event system
- **Room** - Scene/level management with MessagePack data support
- **RoomManager** - Handles room transitions and lifecycle

### Event System (GameMaker-style)
```typescript
// Objects use events: CREATE, STEP, DRAW, DESTROY
player.addEventScript(GameEvent.STEP, (self) => {
  // Game logic here
})
```

### Rendering Architecture
- **Current**: rapid-render immediate-mode rendering
- **Drawing**: DGCDrawingSystem provides GameMaker-style draw functions
- **Sprites**: DGCSprite/SpriteManager handle loading and textures
- **API**: Immediate-mode drawing similar to GameMaker's draw events

## Game Implementation Pattern
```typescript
class MyGame extends DGCGame {
  protected async onGameStart(): Promise<void> {
    // Setup game objects, room data, etc.
    await this.roomManager.loadRoom('main_menu');
  }
}
```

## Key Files
- `src/engine/DGCGame.ts` - Base game class with RoomManager
- `src/engine/DGCEngine.ts` - Rapid-render powered engine
- `src/engine/DGCDrawingSystem.ts` - Immediate-mode drawing API
- `src/engine/GameObject.ts` - Game object base class
- `src/engine/Room.ts` - Room/scene management
- `src/engine/RoomManager.ts` - Room lifecycle and transitions
- `src/engine/SpriteManager.ts` - Sprite loading and texture management
- `src/game/Game.ts` - Demo turn-based game
- `src/game/gameobjects/Player.ts` - Player game object example

## Current State
- ✅ Complete GameMaker-style event system
- ✅ rapid-render immediate-mode rendering engine
- ✅ Room system with MessagePack binary data
- ✅ DGCGame foundation for all games
- ✅ Working turn-based movement demo
- ✅ Grid-based movement with pathfinding
- ✅ Sprite rendering with texture management
- ✅ All builds passing, dev server working

## Development Commands
- `npm run dev` - Start dev server
- `npm run build` - Build for production
- Game instance available at `window.game` in dev mode

## Notes for AI
- Follow existing GameMaker-style patterns
- Use DGCGame for new games, includes RoomManager automatically
- Game objects use event scripts for behavior
- Rooms use MessagePack binary data format (.dgcroom files)
- Engine provides immediate-mode drawing via DGCDrawingSystem
- Sprites managed through SpriteManager
