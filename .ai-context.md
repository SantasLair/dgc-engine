# AI Context: Turn-Based Movement Game Engine

## Project Overview
TypeScript-based game engine with GameMaker-style architecture. Features event-driven game objects, renderer abstraction, and a turn-based movement demo game.

## Tech Stack
- **TypeScript** + **Vite** (build/dev)
- **PIXI.js** (rendering, abstracted via IRenderer)
- **HTML5 Canvas** (render target)
- **EasyStar.js** (A* pathfinding)

## Architecture

### Core Engine (`src/engine/`)
- **BaseGame** - Abstract class all games extend, handles lifecycle
- **GameEngine** - Main coordinator, manages objects/events/rendering
- **GameObject** - Base for all game entities with event system
- **IRenderer** - Abstract interface for rendering backends
- **RendererFactory** - Creates renderer instances (Pixi/Canvas/WebGL)
- **GameEngineConfig** - Unified engine configuration

### Event System (GameMaker-style)
```typescript
// Objects use events: CREATE, STEP, DRAW, COLLISION, MOUSE_*, KEY_*, TIMER
player.addEventScript(GameEvent.STEP, (self) => {
  // Game logic here
})
```

### Renderer Architecture
- **Current**: PixiRenderer in `src/engine/renderers/`
- **Planned**: Canvas, WebGL renderers
- **Interface**: All renderers implement IRenderer
- **Factory**: RendererFactory.createRenderer(type, config)

## Game Implementation Pattern
```typescript
class MyGame extends BaseGame {
  protected getEngineConfig(): GameEngineConfig {
    return { canvas, gridWidth: 20, gridHeight: 15, rendererType: 'pixi' }
  }
  
  protected async setupGame(): Promise<void> {
    // Create game objects, setup events, etc.
  }
}
```

## Key Files
- `src/engine/BaseGame.ts` - Game foundation class
- `src/engine/GameEngine.ts` - Main engine
- `src/engine/IRenderer.ts` - Renderer interface  
- `src/engine/RendererFactory.ts` - Renderer creation
- `src/engine/renderers/PixiRenderer.ts` - PIXI implementation
- `src/game/Game.ts` - Demo turn-based game
- `src/game/Player.ts` - Player game object example

## Current State
- âœ… Complete GameMaker-style event system
- âœ… Renderer abstraction with factory pattern  
- âœ… BaseGame foundation for all games
- âœ… Working turn-based movement demo
- âœ… Grid-based movement with pathfinding
- âœ… All builds passing, dev server working
- ðŸ”„ Canvas/WebGL renderers (planned)

## Development Commands
- `npm run dev` - Start dev server
- `npm run build` - Build for production
- Game instance available at `window.game` in dev mode

## Notes for AI
- Follow existing GameMaker-style patterns
- Use BaseGame for new games, never create Game class from scratch
- Renderers go in `src/engine/renderers/`
- Game objects use event scripts, not inheritance for behavior
- Engine handles all lifecycle, games just configure and setup objects
